{"ast":null,"code":"var D2R = 0.01745329251994329577;\nimport parser from './parser';\nimport { sExpr } from './process';\n\nfunction rename(obj, params) {\n  var outName = params[0];\n  var inName = params[1];\n\n  if (!(outName in obj) && inName in obj) {\n    obj[outName] = obj[inName];\n\n    if (params.length === 3) {\n      obj[outName] = params[2](obj[outName]);\n    }\n  }\n}\n\nfunction d2r(input) {\n  return input * D2R;\n}\n\nfunction cleanWKT(wkt) {\n  if (wkt.type === 'GEOGCS') {\n    wkt.projName = 'longlat';\n  } else if (wkt.type === 'LOCAL_CS') {\n    wkt.projName = 'identity';\n    wkt.local = true;\n  } else {\n    if (typeof wkt.PROJECTION === 'object') {\n      wkt.projName = Object.keys(wkt.PROJECTION)[0];\n    } else {\n      wkt.projName = wkt.PROJECTION;\n    }\n  }\n\n  if (wkt.AXIS) {\n    var axisOrder = '';\n\n    for (var i = 0, ii = wkt.AXIS.length; i < ii; ++i) {\n      var axis = wkt.AXIS[i];\n      var descriptor = axis[0].toLowerCase();\n\n      if (descriptor.indexOf('north') !== -1) {\n        axisOrder += 'n';\n      } else if (descriptor.indexOf('south') !== -1) {\n        axisOrder += 's';\n      } else if (descriptor.indexOf('east') !== -1) {\n        axisOrder += 'e';\n      } else if (descriptor.indexOf('west') !== -1) {\n        axisOrder += 'w';\n      }\n    }\n\n    if (axisOrder.length === 2) {\n      axisOrder += 'u';\n    }\n\n    if (axisOrder.length === 3) {\n      wkt.axis = axisOrder;\n    }\n  }\n\n  if (wkt.UNIT) {\n    wkt.units = wkt.UNIT.name.toLowerCase();\n\n    if (wkt.units === 'metre') {\n      wkt.units = 'meter';\n    }\n\n    if (wkt.UNIT.convert) {\n      if (wkt.type === 'GEOGCS') {\n        if (wkt.DATUM && wkt.DATUM.SPHEROID) {\n          wkt.to_meter = wkt.UNIT.convert * wkt.DATUM.SPHEROID.a;\n        }\n      } else {\n        wkt.to_meter = wkt.UNIT.convert;\n      }\n    }\n  }\n\n  var geogcs = wkt.GEOGCS;\n\n  if (wkt.type === 'GEOGCS') {\n    geogcs = wkt;\n  }\n\n  if (geogcs) {\n    //if(wkt.GEOGCS.PRIMEM&&wkt.GEOGCS.PRIMEM.convert){\n    //  wkt.from_greenwich=wkt.GEOGCS.PRIMEM.convert*D2R;\n    //}\n    if (geogcs.DATUM) {\n      wkt.datumCode = geogcs.DATUM.name.toLowerCase();\n    } else {\n      wkt.datumCode = geogcs.name.toLowerCase();\n    }\n\n    if (wkt.datumCode.slice(0, 2) === 'd_') {\n      wkt.datumCode = wkt.datumCode.slice(2);\n    }\n\n    if (wkt.datumCode === 'new_zealand_geodetic_datum_1949' || wkt.datumCode === 'new_zealand_1949') {\n      wkt.datumCode = 'nzgd49';\n    }\n\n    if (wkt.datumCode === 'wgs_1984' || wkt.datumCode === 'world_geodetic_system_1984') {\n      if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {\n        wkt.sphere = true;\n      }\n\n      wkt.datumCode = 'wgs84';\n    }\n\n    if (wkt.datumCode.slice(-6) === '_ferro') {\n      wkt.datumCode = wkt.datumCode.slice(0, -6);\n    }\n\n    if (wkt.datumCode.slice(-8) === '_jakarta') {\n      wkt.datumCode = wkt.datumCode.slice(0, -8);\n    }\n\n    if (~wkt.datumCode.indexOf('belge')) {\n      wkt.datumCode = 'rnb72';\n    }\n\n    if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {\n      wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\\_18/, 'clrk');\n\n      if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {\n        wkt.ellps = 'intl';\n      }\n\n      wkt.a = geogcs.DATUM.SPHEROID.a;\n      wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);\n    }\n\n    if (geogcs.DATUM && geogcs.DATUM.TOWGS84) {\n      wkt.datum_params = geogcs.DATUM.TOWGS84;\n    }\n\n    if (~wkt.datumCode.indexOf('osgb_1936')) {\n      wkt.datumCode = 'osgb36';\n    }\n\n    if (~wkt.datumCode.indexOf('osni_1952')) {\n      wkt.datumCode = 'osni52';\n    }\n\n    if (~wkt.datumCode.indexOf('tm65') || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {\n      wkt.datumCode = 'ire65';\n    }\n\n    if (wkt.datumCode === 'ch1903+') {\n      wkt.datumCode = 'ch1903';\n    }\n\n    if (~wkt.datumCode.indexOf('israel')) {\n      wkt.datumCode = 'isr93';\n    }\n  }\n\n  if (wkt.b && !isFinite(wkt.b)) {\n    wkt.b = wkt.a;\n  }\n\n  function toMeter(input) {\n    var ratio = wkt.to_meter || 1;\n    return input * ratio;\n  }\n\n  var renamer = function (a) {\n    return rename(wkt, a);\n  };\n\n  var list = [['standard_parallel_1', 'Standard_Parallel_1'], ['standard_parallel_2', 'Standard_Parallel_2'], ['false_easting', 'False_Easting'], ['false_northing', 'False_Northing'], ['central_meridian', 'Central_Meridian'], ['latitude_of_origin', 'Latitude_Of_Origin'], ['latitude_of_origin', 'Central_Parallel'], ['scale_factor', 'Scale_Factor'], ['k0', 'scale_factor'], ['latitude_of_center', 'Latitude_Of_Center'], ['latitude_of_center', 'Latitude_of_center'], ['lat0', 'latitude_of_center', d2r], ['longitude_of_center', 'Longitude_Of_Center'], ['longitude_of_center', 'Longitude_of_center'], ['longc', 'longitude_of_center', d2r], ['x0', 'false_easting', toMeter], ['y0', 'false_northing', toMeter], ['long0', 'central_meridian', d2r], ['lat0', 'latitude_of_origin', d2r], ['lat0', 'standard_parallel_1', d2r], ['lat1', 'standard_parallel_1', d2r], ['lat2', 'standard_parallel_2', d2r], ['azimuth', 'Azimuth'], ['alpha', 'azimuth', d2r], ['srsCode', 'name']];\n  list.forEach(renamer);\n\n  if (!wkt.long0 && wkt.longc && (wkt.projName === 'Albers_Conic_Equal_Area' || wkt.projName === 'Lambert_Azimuthal_Equal_Area')) {\n    wkt.long0 = wkt.longc;\n  }\n\n  if (!wkt.lat_ts && wkt.lat1 && (wkt.projName === 'Stereographic_South_Pole' || wkt.projName === 'Polar Stereographic (variant B)')) {\n    wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);\n    wkt.lat_ts = wkt.lat1;\n  }\n}\n\nexport default function (wkt) {\n  var lisp = parser(wkt);\n  var type = lisp.shift();\n  var name = lisp.shift();\n  lisp.unshift(['name', name]);\n  lisp.unshift(['type', type]);\n  var obj = {};\n  sExpr(lisp, obj);\n  cleanWKT(obj);\n  return obj;\n}","map":{"version":3,"sources":["/home/enrique/projects/TFG/frontend/node_modules/wkt-parser/index.js"],"names":["D2R","parser","sExpr","rename","obj","params","outName","inName","length","d2r","input","cleanWKT","wkt","type","projName","local","PROJECTION","Object","keys","AXIS","axisOrder","i","ii","axis","descriptor","toLowerCase","indexOf","UNIT","units","name","convert","DATUM","SPHEROID","to_meter","a","geogcs","GEOGCS","datumCode","slice","sphere","ellps","replace","rf","parseFloat","TOWGS84","datum_params","b","isFinite","toMeter","ratio","renamer","list","forEach","long0","longc","lat_ts","lat1","lat0","lisp","shift","unshift"],"mappings":"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","sourcesContent":["var D2R = 0.01745329251994329577;\nimport parser from './parser';\nimport {sExpr} from './process';\n\n\n\nfunction rename(obj, params) {\n  var outName = params[0];\n  var inName = params[1];\n  if (!(outName in obj) && (inName in obj)) {\n    obj[outName] = obj[inName];\n    if (params.length === 3) {\n      obj[outName] = params[2](obj[outName]);\n    }\n  }\n}\n\nfunction d2r(input) {\n  return input * D2R;\n}\n\nfunction cleanWKT(wkt) {\n  if (wkt.type === 'GEOGCS') {\n    wkt.projName = 'longlat';\n  } else if (wkt.type === 'LOCAL_CS') {\n    wkt.projName = 'identity';\n    wkt.local = true;\n  } else {\n    if (typeof wkt.PROJECTION === 'object') {\n      wkt.projName = Object.keys(wkt.PROJECTION)[0];\n    } else {\n      wkt.projName = wkt.PROJECTION;\n    }\n  }\n  if (wkt.AXIS) {\n    var axisOrder = '';\n    for (var i = 0, ii = wkt.AXIS.length; i < ii; ++i) {\n      var axis = wkt.AXIS[i];\n      var descriptor = axis[0].toLowerCase();\n      if (descriptor.indexOf('north') !== -1) {\n        axisOrder += 'n';\n      } else if (descriptor.indexOf('south') !== -1) {\n        axisOrder += 's';\n      } else if (descriptor.indexOf('east') !== -1) {\n        axisOrder += 'e';\n      } else if (descriptor.indexOf('west') !== -1) {\n        axisOrder += 'w';\n      }\n    }\n    if (axisOrder.length === 2) {\n      axisOrder += 'u';\n    }\n    if (axisOrder.length === 3) {\n      wkt.axis = axisOrder;\n    }\n  }\n  if (wkt.UNIT) {\n    wkt.units = wkt.UNIT.name.toLowerCase();\n    if (wkt.units === 'metre') {\n      wkt.units = 'meter';\n    }\n    if (wkt.UNIT.convert) {\n      if (wkt.type === 'GEOGCS') {\n        if (wkt.DATUM && wkt.DATUM.SPHEROID) {\n          wkt.to_meter = wkt.UNIT.convert*wkt.DATUM.SPHEROID.a;\n        }\n      } else {\n        wkt.to_meter = wkt.UNIT.convert;\n      }\n    }\n  }\n  var geogcs = wkt.GEOGCS;\n  if (wkt.type === 'GEOGCS') {\n    geogcs = wkt;\n  }\n  if (geogcs) {\n    //if(wkt.GEOGCS.PRIMEM&&wkt.GEOGCS.PRIMEM.convert){\n    //  wkt.from_greenwich=wkt.GEOGCS.PRIMEM.convert*D2R;\n    //}\n    if (geogcs.DATUM) {\n      wkt.datumCode = geogcs.DATUM.name.toLowerCase();\n    } else {\n      wkt.datumCode = geogcs.name.toLowerCase();\n    }\n    if (wkt.datumCode.slice(0, 2) === 'd_') {\n      wkt.datumCode = wkt.datumCode.slice(2);\n    }\n    if (wkt.datumCode === 'new_zealand_geodetic_datum_1949' || wkt.datumCode === 'new_zealand_1949') {\n      wkt.datumCode = 'nzgd49';\n    }\n    if (wkt.datumCode === 'wgs_1984' || wkt.datumCode === 'world_geodetic_system_1984') {\n      if (wkt.PROJECTION === 'Mercator_Auxiliary_Sphere') {\n        wkt.sphere = true;\n      }\n      wkt.datumCode = 'wgs84';\n    }\n    if (wkt.datumCode.slice(-6) === '_ferro') {\n      wkt.datumCode = wkt.datumCode.slice(0, - 6);\n    }\n    if (wkt.datumCode.slice(-8) === '_jakarta') {\n      wkt.datumCode = wkt.datumCode.slice(0, - 8);\n    }\n    if (~wkt.datumCode.indexOf('belge')) {\n      wkt.datumCode = 'rnb72';\n    }\n    if (geogcs.DATUM && geogcs.DATUM.SPHEROID) {\n      wkt.ellps = geogcs.DATUM.SPHEROID.name.replace('_19', '').replace(/[Cc]larke\\_18/, 'clrk');\n      if (wkt.ellps.toLowerCase().slice(0, 13) === 'international') {\n        wkt.ellps = 'intl';\n      }\n\n      wkt.a = geogcs.DATUM.SPHEROID.a;\n      wkt.rf = parseFloat(geogcs.DATUM.SPHEROID.rf, 10);\n    }\n\n    if (geogcs.DATUM && geogcs.DATUM.TOWGS84) {\n      wkt.datum_params = geogcs.DATUM.TOWGS84;\n    }\n    if (~wkt.datumCode.indexOf('osgb_1936')) {\n      wkt.datumCode = 'osgb36';\n    }\n    if (~wkt.datumCode.indexOf('osni_1952')) {\n      wkt.datumCode = 'osni52';\n    }\n    if (~wkt.datumCode.indexOf('tm65')\n      || ~wkt.datumCode.indexOf('geodetic_datum_of_1965')) {\n      wkt.datumCode = 'ire65';\n    }\n    if (wkt.datumCode === 'ch1903+') {\n      wkt.datumCode = 'ch1903';\n    }\n    if (~wkt.datumCode.indexOf('israel')) {\n      wkt.datumCode = 'isr93';\n    }\n  }\n  if (wkt.b && !isFinite(wkt.b)) {\n    wkt.b = wkt.a;\n  }\n\n  function toMeter(input) {\n    var ratio = wkt.to_meter || 1;\n    return input * ratio;\n  }\n  var renamer = function(a) {\n    return rename(wkt, a);\n  };\n  var list = [\n    ['standard_parallel_1', 'Standard_Parallel_1'],\n    ['standard_parallel_2', 'Standard_Parallel_2'],\n    ['false_easting', 'False_Easting'],\n    ['false_northing', 'False_Northing'],\n    ['central_meridian', 'Central_Meridian'],\n    ['latitude_of_origin', 'Latitude_Of_Origin'],\n    ['latitude_of_origin', 'Central_Parallel'],\n    ['scale_factor', 'Scale_Factor'],\n    ['k0', 'scale_factor'],\n    ['latitude_of_center', 'Latitude_Of_Center'],\n    ['latitude_of_center', 'Latitude_of_center'],\n    ['lat0', 'latitude_of_center', d2r],\n    ['longitude_of_center', 'Longitude_Of_Center'],\n    ['longitude_of_center', 'Longitude_of_center'],\n    ['longc', 'longitude_of_center', d2r],\n    ['x0', 'false_easting', toMeter],\n    ['y0', 'false_northing', toMeter],\n    ['long0', 'central_meridian', d2r],\n    ['lat0', 'latitude_of_origin', d2r],\n    ['lat0', 'standard_parallel_1', d2r],\n    ['lat1', 'standard_parallel_1', d2r],\n    ['lat2', 'standard_parallel_2', d2r],\n    ['azimuth', 'Azimuth'],\n    ['alpha', 'azimuth', d2r],\n    ['srsCode', 'name']\n  ];\n  list.forEach(renamer);\n  if (!wkt.long0 && wkt.longc && (wkt.projName === 'Albers_Conic_Equal_Area' || wkt.projName === 'Lambert_Azimuthal_Equal_Area')) {\n    wkt.long0 = wkt.longc;\n  }\n  if (!wkt.lat_ts && wkt.lat1 && (wkt.projName === 'Stereographic_South_Pole' || wkt.projName === 'Polar Stereographic (variant B)')) {\n    wkt.lat0 = d2r(wkt.lat1 > 0 ? 90 : -90);\n    wkt.lat_ts = wkt.lat1;\n  }\n}\nexport default function(wkt) {\n  var lisp = parser(wkt);\n  var type = lisp.shift();\n  var name = lisp.shift();\n  lisp.unshift(['name', name]);\n  lisp.unshift(['type', type]);\n  var obj = {};\n  sExpr(lisp, obj);\n  cleanWKT(obj);\n  return obj;\n}\n"]},"metadata":{},"sourceType":"module"}